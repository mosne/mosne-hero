(()=>{"use strict";const e=window.wp.blocks,o=window.wp.hooks,l=window.wp.compose,i=window.wp.blockEditor,t=window.wp.components,r=window.wp.i18n,n=window.wp.data,a=window.wp.element,s=window.wp.blob,m=window.ReactJSXRuntime,c=t.FocalPointPicker||null;(0,e.registerBlockVariation)("core/cover",{name:"mosne-hero-cover",title:(0,r.__)("Hero Cover (Mobile & Desktop)","mosne-hero"),description:(0,r.__)("Cover block with separate mobile and desktop background images and sizes.","mosne-hero"),attributes:{variation:"mosne-hero-cover"},isDefault:!1,scope:["inserter","transform"]});const u=(0,l.createHigherOrderComponent)(e=>o=>{const{name:l,attributes:u,setAttributes:h,clientId:d}=o;if(!e||"function"!=typeof e)return null;if("core/cover"!==l)return(0,m.jsx)(e,{...o});if("mosne-hero-cover"!==u.variation)return(0,m.jsx)(e,{...o});const{mobileImageId:g=0,mobileImageUrl:b="",mobileFocalPoint:p,mobileImageSize:_="large",mobileImageAlt:w="",highFetchPriority:v=!1}=u,f=(0,n.useSelect)(e=>{if(!g||0===g)return null;try{const o=e("core").getMedia(g);return o&&void 0!==o?o:null}catch(e){return null}},[g]),I=(0,n.useSelect)(e=>{const o=e("core/block-editor").getSettings(),l=(o?.imageSizes||[]).map(e=>({label:e.name||e.slug,value:e.slug}));return l.some(e=>"full"===e.value)||l.unshift({label:(0,r.__)("Full Size","mosne-hero"),value:"full"}),0===l.length?[{label:(0,r.__)("Full Size","mosne-hero"),value:"full"},{label:(0,r.__)("Large","mosne-hero"),value:"large"},{label:(0,r.__)("Medium Large","mosne-hero"),value:"medium_large"},{label:(0,r.__)("Medium","mosne-hero"),value:"medium"},{label:(0,r.__)("Thumbnail","mosne-hero"),value:"thumbnail"}]:l},[]),x=(e,o)=>e?"full"===o?e.source_url||e.url||"":e.media_details?.sizes?.[o]?.source_url?e.media_details.sizes[o].source_url:e.source_url||e.url||"":"";(0,a.useEffect)(()=>{if(f){const e=x(f,_||"large");e&&h({mobileImageUrl:e})}},[f,_]);const y=()=>{h({mobileImageId:0,mobileImageUrl:"",mobileFocalPoint:void 0,mobileImageAlt:""})},k=p||{x:.5,y:.5};return t.PanelBody&&i.MediaUpload&&i.MediaUploadCheck&&t.SelectControl&&t.Button&&i.InspectorControls?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(e,{...o}),(0,m.jsx)(i.InspectorControls,{children:(0,m.jsxs)(t.PanelBody,{title:(0,r.__)("Mobile Image","mosne-hero"),initialOpen:!0,children:[(0,m.jsx)(t.SelectControl,{label:(0,r.__)("Mobile Image Size","mosne-hero"),value:_||"large",options:I,onChange:e=>{if(h({mobileImageSize:e}),f){const o=x(f,e);o&&h({mobileImageUrl:o})}},help:(0,r.__)("Choose the image size for mobile view. If no mobile image is selected, the desktop image will be used with this size.","mosne-hero")}),(0,m.jsx)(t.ToggleControl,{label:(0,r.__)("High Fetch Priority","mosne-hero"),checked:v,onChange:e=>h({highFetchPriority:e}),help:(0,r.__)("Prioritize loading of both desktop and mobile images. Use for above-the-fold hero images.","mosne-hero")}),(0,m.jsx)(i.MediaUploadCheck,{children:(0,m.jsx)(i.MediaUpload,{onSelect:e=>{const o=x(e,_||"large");h({variation:u.variation||"mosne-hero-cover",mobileImageId:e.id,mobileImageUrl:o,mobileFocalPoint:p||{x:.5,y:.5},mobileImageSize:_||"large",mobileImageAlt:w||e.alt||""})},allowedTypes:["image"],value:g>0?g:void 0,render:({open:e})=>{if("function"!=typeof e)return null;const o=b&&"string"==typeof b&&!(0,s.isBlobURL)(b);return(0,m.jsx)("div",{children:o?(0,m.jsxs)(m.Fragment,{children:[c&&(0,m.jsx)(c,{label:(0,r.__)("Focal Point Picker","mosne-hero"),url:b,value:k,onChange:e=>{e&&"object"==typeof e&&"number"==typeof e.x&&"number"==typeof e.y&&h({mobileFocalPoint:e})}}),(0,m.jsx)(t.TextControl,{label:(0,r.__)("Alt Text","mosne-hero"),value:w||"",onChange:e=>h({mobileImageAlt:e}),help:(0,r.__)("Describe the purpose of the image. Leave empty to use the image's default alt text.","mosne-hero")}),(0,m.jsx)(t.Button,{onClick:y,variant:"secondary",isDestructive:!0,style:{marginTop:"10px",width:"100%"},children:(0,r.__)("Remove mobile image","mosne-hero")})]}):(0,m.jsx)(t.Button,{onClick:e,variant:"primary",children:g&&g>0?(0,r.__)("Replace mobile image","mosne-hero"):(0,r.__)("Select mobile image","mosne-hero")})})}})})]})},"mosne-hero-mobile-image")]}):(0,m.jsx)(e,{...o})},"withMobileImageControls");(0,o.addFilter)("editor.BlockEdit","mosne-hero/cover-with-mobile-image",u,20)})();