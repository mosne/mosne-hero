(()=>{"use strict";const e=window.wp.blocks,o=window.wp.hooks,i=window.wp.compose,l=window.wp.i18n,n=window.wp.blockEditor,t=window.wp.components,r=window.wp.element,a=window.wp.blob;function s(e,o){return e?"full"===o?e.source_url||e.url||"":e.media_details?.sizes?.[o]?.source_url?e.media_details.sizes[o].source_url:e.source_url||e.url||"":""}const m=window.wp.data,c=window.ReactJSXRuntime;function u({attributes:e,setAttributes:o}){const{mobileImageId:i=0,mobileImageUrl:u="",mobileFocalPoint:h,mobileImageSize:d="large",mobileImageAlt:b="",highFetchPriority:g=!1}=e,_=function(e){return(0,m.useSelect)(o=>{if(!e||0===e)return null;try{const i=o("core").getMedia(e);return i&&void 0!==i?i:null}catch(e){return null}},[e])}(i),p=(0,m.useSelect)(e=>{const o=e("core/block-editor").getSettings(),i=(o?.imageSizes||[]).map(e=>({label:e.name||e.slug,value:e.slug}));return i.some(e=>"full"===e.value)||i.unshift({label:(0,l.__)("Full Size","mosne-hero"),value:"full"}),0===i.length?[{label:(0,l.__)("Full Size","mosne-hero"),value:"full"},{label:(0,l.__)("Large","mosne-hero"),value:"large"},{label:(0,l.__)("Medium Large","mosne-hero"),value:"medium_large"},{label:(0,l.__)("Medium","mosne-hero"),value:"medium"},{label:(0,l.__)("Thumbnail","mosne-hero"),value:"thumbnail"}]:i},[]),v=function(e){const o=e.hasParallax||!1,i=e.backgroundType||"image",l=e.isRepeated||!1;return o||"image"!==i||l}(e),w=function(e){const o=e.hasParallax||!1,i=e.backgroundType||"image",n=e.isRepeated||!1,t=[];if(o&&t.push((0,l.__)("Parallax","mosne-hero")),"image"!==i){const e="video"===i?(0,l.__)("Video background","mosne-hero"):(0,l.__)("Non-image background","mosne-hero");t.push(e)}if(n&&t.push((0,l.__)("Repeated","mosne-hero")),0===t.length)return"";if(1===t.length)return(0,l.sprintf)(/* translators: %s: feature name (e.g., Parallax, Video background) */ /* translators: %s: feature name (e.g., Parallax, Video background) */
(0,l.__)("The mobile version is not available when %s is enabled.","mosne-hero"),t[0]);if(2===t.length)return(0,l.sprintf)(/* translators: %1$s: first feature, %2$s: second feature */ /* translators: %1$s: first feature, %2$s: second feature */
(0,l.__)("The mobile version is not available when %1$s or %2$s are enabled.","mosne-hero"),t[0],t[1]);const r=t.pop(),a=t.join(", ");return(0,l.sprintf)(/* translators: %1$s: list of features, %2$s: last feature */ /* translators: %1$s: list of features, %2$s: last feature */
(0,l.__)("The mobile version is not available when %1$s, and %2$s are enabled.","mosne-hero"),a,r)}(e);(0,r.useEffect)(()=>{if(_){const e=s(_,d||"large");e&&o({mobileImageUrl:e})}},[_,d]);const f=()=>{v||o({mobileImageId:0,mobileImageUrl:"",mobileFocalPoint:void 0,mobileImageAlt:""})},x=h||{x:.5,y:.5},k=u&&"string"==typeof u&&!(0,a.isBlobURL)(u);return(0,c.jsx)(n.InspectorControls,{children:(0,c.jsxs)(t.PanelBody,{title:(0,l.__)("Mobile Image","mosne-hero"),initialOpen:!0,children:[v&&w&&(0,c.jsx)(t.Notice,{status:"warning",isDismissible:!1,className:"mosne-hero-warning",children:w}),(0,c.jsx)(t.SelectControl,{label:(0,l.__)("Mobile Image Size","mosne-hero"),value:d||"large",options:p,disabled:v,onChange:e=>{if(!v&&(o({mobileImageSize:e}),_)){const i=s(_,e);i&&o({mobileImageUrl:i})}},help:(0,l.__)("Choose the image size for mobile view. If no mobile image is selected, the desktop image will be used with this size.","mosne-hero")}),(0,c.jsx)(t.ToggleControl,{label:(0,l.__)("High Fetch Priority","mosne-hero"),checked:g,disabled:v,onChange:e=>{v||o({highFetchPriority:e})},help:(0,l.__)("Prioritize loading of both desktop and mobile images. Use for above-the-fold hero images.","mosne-hero")}),(0,c.jsx)(n.MediaUploadCheck,{children:(0,c.jsx)(n.MediaUpload,{onSelect:i=>{if(v)return;const l=s(i,d||"large");o({variation:e.variation||"mosne-hero-cover",mobileImageId:i.id,mobileImageUrl:l,mobileFocalPoint:h||{x:.5,y:.5},mobileImageSize:d||"large",mobileImageAlt:b||i.alt||""})},allowedTypes:["image"],value:i>0?i:void 0,render:({open:e})=>"function"!=typeof e?null:(0,c.jsx)("div",{children:k?(0,c.jsxs)(c.Fragment,{children:[t.FocalPointPicker&&(0,c.jsx)(t.FocalPointPicker,{label:(0,l.__)("Focal Point Picker","mosne-hero"),url:u,value:x,disabled:v,onChange:e=>{v||e&&"object"==typeof e&&"number"==typeof e.x&&"number"==typeof e.y&&o({mobileFocalPoint:e})}}),(0,c.jsx)(t.TextareaControl,{label:(0,l.__)("Alt Text","mosne-hero"),value:b||"",rows:4,disabled:v,onChange:e=>{v||o({mobileImageAlt:e})},help:(0,l.__)("Describe the purpose of the image. Leave empty to use the image's default alt text.","mosne-hero")}),(0,c.jsx)(t.Button,{onClick:f,variant:"secondary",isDestructive:!0,disabled:v,style:{marginTop:"10px",width:"100%",justifyContent:"center"},children:(0,l.__)("Remove mobile image","mosne-hero")})]}):(0,c.jsx)(t.Button,{onClick:()=>{v||e()},variant:"primary",disabled:v,children:i&&i>0?(0,l.__)("Replace mobile image","mosne-hero"):(0,l.__)("Select mobile image","mosne-hero")})})})})]})},"mosne-hero-mobile-image")}(0,e.registerBlockVariation)("core/cover",{name:"mosne-hero-cover",title:(0,l.__)("Hero Cover (Mobile & Desktop)","mosne-hero"),description:(0,l.__)("Cover block with separate mobile and desktop background images and sizes.","mosne-hero"),attributes:{variation:"mosne-hero-cover"},isDefault:!1,scope:["inserter","transform"]});const h=(0,i.createHigherOrderComponent)(e=>o=>{const{name:i,attributes:l}=o;return e&&"function"==typeof e?"core/cover"!==i?(0,c.jsx)(e,{...o}):"mosne-hero-cover"===l.variation?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e,{...o}),(0,c.jsx)(u,{attributes:l,setAttributes:o.setAttributes})]}):(0,c.jsx)(e,{...o}):null},"withMobileImageControls");(0,o.addFilter)("editor.BlockEdit","mosne-hero/cover-with-mobile-image",h,20)})();